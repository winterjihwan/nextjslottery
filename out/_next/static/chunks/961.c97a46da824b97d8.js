"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[961],{10961:function(e,r,t){t.r(r),t.d(r,{EthereumPrivateKeyProvider:function(){return ea},TransactionFormatter:function(){return et},WalletConnectProvider:function(){return T},getProviderHandlers:function(){return $}});var n=t(4942),i=t(22782),a=t(95844),o=t(16843),s=t(68531),c=t(79826),f=t(66052),u=t(51091),d=t(53934),l=t(20917),h=t(69282),p=t.n(h),g=t(40660),y=t(70794),m=t(2832),v=t.n(m),P=t(48764).Buffer;function w(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function b(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?w(Object(t),!0).forEach(function(r){(0,n.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):w(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function E(e){return 42===e.length}function x(e){let{getAccounts:r,getPrivateKey:t,processTransaction:n,processSignTransaction:i,processEthSignMessage:o,processTypedMessage:s,processTypedMessageV3:f,processTypedMessageV4:u,processPersonalMessage:d,processEncryptionPublicKey:l,processDecryptMessage:h}=e,p=(0,a.UZ)([(0,a.v0)({eth_syncing:!1}),function(e){let{getAccounts:r,getPrivateKey:t,processDecryptMessage:n,processEncryptionPublicKey:i,processEthSignMessage:o,processPersonalMessage:s,processTransaction:f,processSignTransaction:u,processTypedMessage:d,processTypedMessageV3:l,processTypedMessageV4:h}=e;if(!r)throw Error("opts.getAccounts is required");async function p(e,t){if("string"==typeof e&&e.length>0){let n=await r(t),i=n.map(e=>e.toLowerCase()),a=e.toLowerCase();if(i.includes(a))return a}throw c.ethErrors.rpc.invalidParams({message:"Invalid parameters: must provide an Ethereum address."})}async function g(e,t){t.result=await r(e)}async function y(e,t){let n=await r(e);t.result=n[0]||null}async function m(e,r){if(!f)throw c.ethErrors.rpc.methodNotSupported();let t=e.params[0]||{from:""};t.from=await p(t.from,e),r.result=await f(t,e)}async function v(e,r){if(!u)throw c.ethErrors.rpc.methodNotSupported();let t=e.params[0]||{from:""};t.from=await p(t.from,e),r.result=await u(t,e)}async function P(e,r){if(!o)throw c.ethErrors.rpc.methodNotSupported();let t=await p(e.params[0],e),n=e.params[1],i=e.params[2]||{},a=b(b({},i),{},{from:t,data:n});r.result=await o(a,e)}async function w(e,r){if(!d)throw c.ethErrors.rpc.methodNotSupported();let t=e.params[0],n=await p(e.params[1],e),i=e.params[2]||{},a=b(b({},i),{},{from:n,data:t});r.result=await d(a,e,"V1")}async function x(e,r){if(!l)throw c.ethErrors.rpc.methodNotSupported();let t=await p(e.params[0],e),n=e.params[1];r.result=await l({data:n,from:t,version:"V3"},e,"V3")}async function _(e,r){if(!h)throw c.ethErrors.rpc.methodNotSupported();let t=await p(e.params[0],e),n=e.params[1];r.result=await h({data:n,from:t,version:"V4"},e,"V4")}async function A(e,r){if(!s)throw c.ethErrors.rpc.methodNotSupported();let t=e.params[0],n=e.params[1],i=e.params[2]||{},a,o;if(E(t)&&!E(n)){let f="The eth_personalSign method requires params ordered ";f+="[message, address]. This was previously handled incorrectly, ",f+="and has been corrected automatically. ",f+="Please switch this param order for smooth behavior in the future.",r.warning=f,a=t,o=n}else o=t,a=n;a=await p(a,e);let u=b(b({},i),{},{from:a,data:o});r.result=await s(u,e)}async function O(e,r){if(!i)throw c.ethErrors.rpc.methodNotSupported();let t=await p(e.params[0],e);r.result=await i(t,e)}async function T(e,r){if(!n)throw c.ethErrors.rpc.methodNotSupported();let t=e.params[0],i=await p(e.params[1],e),a=e.params[2]||{},o=b(b({},a),{},{from:i,data:t});r.result=n(o,e)}async function S(e,r){if(!t)throw c.ethErrors.rpc.methodNotSupported();r.result=t(e)}return(0,a.v0)({eth_accounts:(0,a.Pk)(g),eth_private_key:(0,a.Pk)(S),eth_coinbase:(0,a.Pk)(y),eth_sendTransaction:(0,a.Pk)(m),eth_signTransaction:(0,a.Pk)(v),eth_sign:(0,a.Pk)(P),eth_signTypedData:(0,a.Pk)(w),eth_signTypedData_v3:(0,a.Pk)(x),eth_signTypedData_v4:(0,a.Pk)(_),personal_sign:(0,a.Pk)(A),eth_getEncryptionPublicKey:(0,a.Pk)(O),eth_decrypt:(0,a.Pk)(T)})}({getAccounts:r,getPrivateKey:t,processTransaction:n,processEthSignMessage:o,processSignTransaction:i,processTypedMessage:s,processTypedMessageV3:f,processTypedMessageV4:u,processPersonalMessage:d,processEncryptionPublicKey:l,processDecryptMessage:h})]);return p}function _(e){var r,t;let{chainId:n,rpcTarget:o}=e,s=(0,i.v$)({rpcTarget:o}),c=(0,a.UZ)([(e,r,t,i)=>"eth_chainId"===e.method?(r.result=n,i()):t(),(r,t,n,i)=>"eth_provider_config"===r.method?(t.result=e,i()):n(),s]);return{networkMiddleware:c,fetchMiddleware:s}}function A(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function O(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?A(Object(t),!0).forEach(function(r){(0,n.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):A(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}class T extends s.Zk{constructor(e){let{config:r,state:t,connector:i}=e;super({config:{chainConfig:O(O({},r.chainConfig),{},{chainNamespace:o.EN.EIP155}),skipLookupNetwork:!!r.skipLookupNetwork},state:O(O({},t||{}),{},{chainId:"loading",accounts:[]})}),(0,n.Z)(this,"connector",null),this.connector=i||null}async enable(){if(!this.connector)throw c.ethErrors.provider.custom({message:"Connector is not initialized, pass wallet connect connector in constructor",code:4902});return await this.setupProvider(this.connector),this._providerEngineProxy.request({method:"eth_accounts"})}async setupProvider(e){this.onConnectorStateUpdate(e),await this.setupEngine(e)}async switchChain(e){let{chainId:r,addChain:t=!0,lookup:n=!0}=e;if(!this.connector)throw c.ethErrors.provider.custom({message:"Connector is not initialized, pass wallet connect connector in constructor",code:4902});let i=this.getChainConfig(r);this.update({chainId:"loading"});let{rpcTarget:a,displayName:s}=i;if(t)try{await this.connector.sendCustomRequest({method:"wallet_addEthereumChain",params:[{chainId:r,chainName:s,rpcUrls:[a]}]})}catch(f){o.cM.error(f)}try{await this.connector.sendCustomRequest({method:"wallet_switchEthereumChain",params:[{chainId:r}]})}catch(u){if(o.cM.error(u),"JSON RPC response format is invalid"!==u.message)throw u}this.configure({chainConfig:i}),n&&await this.lookupNetwork(this.connector)}async addChain(e){if(!this.connector)throw o.Ty.notReady("Wallet adapter is not ready yet");let{rpcTarget:r,displayName:t}=e;try{await this.connector.sendCustomRequest({method:"wallet_addEthereumChain",params:[{chainId:e.chainId,chainName:t,rpcUrls:[r]}]}),super.addChain(e)}catch(n){throw o.cM.error(n),n}}async lookupNetwork(e){if(!e.connected)throw o.RM.notConnectedError("Wallet connect connector is not connected");if(!this.provider)throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});let{chainId:r}=this.config.chainConfig,t=(0,o.H2)(e.chainId.toString())?e.chainId:`0x${e.chainId.toString(16)}`;if(r!==t)throw o.Ty.rpcConnectionError(`Invalid network, net_version is: ${t}, expected: ${r}`);return this.provider.emit("connect",{chainId:r}),this.provider.emit("chainChanged",this.state.chainId),t}async setupEngine(e){let r=function(e){let{connector:r}=e;return{async getPrivateKey(){throw c.ethErrors.rpc.methodNotSupported()},async getAccounts(e){let{accounts:t}=r;if(t&&t.length)return t;throw Error("Failed to get accounts")},async processTransaction(e,t){let n=await r.sendTransaction(e);return n},async processSignTransaction(e,t){let n=await r.signTransaction(e);return n},async processEthSignMessage(e,t){let n=await r.signMessage([e.from,e.data]);return n},async processPersonalMessage(e,t){let n=await r.signPersonalMessage([e.data,e.from]);return n},async processTypedMessage(e,t){let n=await r.signTypedData([e.from,e.data]);return n},async processTypedMessageV3(e){let t=await r.signTypedData([e.from,e.data]);return t},async processTypedMessageV4(e){let t=await r.signTypedData([e.from,e.data]);return t},async processEncryptionPublicKey(e){throw c.ethErrors.rpc.methodNotSupported()},processDecryptMessage(e){throw c.ethErrors.rpc.methodNotSupported()}}}({connector:e});this.update({accounts:e.accounts||[]});let t=x(r),n=new a.eI,{networkMiddleware:o}=_(this.config.chainConfig);n.push(t),n.push(o);let s=(0,i.Xj)(n);this.updateProviderEngineProxy(s),this.config.skipLookupNetwork||await this.lookupNetwork(e)}async onConnectorStateUpdate(e){e.on("session_update",async(r,t)=>{if(!this.provider)throw o.RM.notConnectedError("Wallet connect connector is not connected");if(r){this.provider.emit("error",r);return}let{accounts:n,chainId:i,rpcUrl:a}=t.params[0];null!=n&&n.length&&this.state.accounts[0]!==n[0]&&(this.update({accounts:n}),this.provider.emit("accountsChanged",n));let s=`0x${i.toString(16)}`;if(i&&this.state.chainId!==s){let c=(0,o.h2)(o.EN.EIP155,i)||{};this.configure({chainConfig:O(O({},c),{},{chainId:s,rpcTarget:a,chainNamespace:o.EN.EIP155})}),await this.setupEngine(e)}})}}(0,n.Z)(T,"getProviderInstance",async e=>{let r=new T({config:{chainConfig:e.chainConfig,skipLookupNetwork:e.skipLookupNetwork}});return await r.setupProvider(e.connector),r});let S=new y.Z("1e18"),C=new y.Z("1e9"),N=new y.Z("1"),k={hex:e=>"string"==typeof e?new y.Z((0,d.stripHexPrefix)(e),16):new y.Z(e,16),dec:e=>new y.Z(e,10)},I={WEI:e=>e.div(S),GWEI:e=>e.div(C),ETH:e=>e.div(N)},B={WEI:e=>e.times(S).dp(0,y.Z.ROUND_HALF_UP),GWEI:e=>e.times(C).dp(9,y.Z.ROUND_HALF_UP),ETH:e=>e.times(N).dp(9,y.Z.ROUND_HALF_UP)},j={hex:e=>e.toString(16),dec:e=>new y.Z(e).toString(10)},M=e=>{let{value:r,fromNumericBase:t,fromDenomination:n,toNumericBase:i,toDenomination:a,numberOfDecimals:o}=e,s=k[t](r);return n&&(s=I[n](s)),a&&(s=B[a](s)),o&&(s=s.dp(o,y.Z.ROUND_HALF_DOWN)),i&&(s=j[i](s)),s},H=(e,r)=>{let{fromNumericBase:t="hex",toNumericBase:n,fromDenomination:i,toDenomination:a,numberOfDecimals:o}=r;return M({fromNumericBase:t,toNumericBase:n,fromDenomination:i,toDenomination:a,numberOfDecimals:o,value:e||"0"})};function G(e){return H(e,{fromNumericBase:"dec",toNumericBase:"hex",fromDenomination:"GWEI",toDenomination:"WEI"})}function F(e){return H(e,{fromNumericBase:"hex",toNumericBase:"dec",fromDenomination:"WEI",toDenomination:"GWEI"})}function L(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function K(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?L(Object(t),!0).forEach(function(r){(0,n.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):L(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function D(e){let r=G(e),t=F(r);return t}async function R(e){let r=await (0,l.U2)(e),t=K(K({},r),{},{estimatedBaseFee:D(r.estimatedBaseFee),low:K(K({},r.low),{},{suggestedMaxPriorityFeePerGas:D(r.low.suggestedMaxPriorityFeePerGas),suggestedMaxFeePerGas:D(r.low.suggestedMaxFeePerGas)}),medium:K(K({},r.medium),{},{suggestedMaxPriorityFeePerGas:D(r.medium.suggestedMaxPriorityFeePerGas),suggestedMaxFeePerGas:D(r.medium.suggestedMaxFeePerGas)}),high:K(K({},r.high),{},{suggestedMaxPriorityFeePerGas:D(r.high.suggestedMaxPriorityFeePerGas),suggestedMaxFeePerGas:D(r.high.suggestedMaxFeePerGas)})});return t}async function U(e){let r=await (0,l.U2)(e,{referrer:e,referrerPolicy:"no-referrer-when-downgrade",method:"GET",mode:"cors"});return{low:r.SafeGasPrice,medium:r.ProposeGasPrice,high:r.FastGasPrice}}let V=(e,r)=>{var t;try{p().ok(e&&"object"==typeof e,"Params must be an object."),p().ok("data"in e,'Params must include a "data" field.'),p().ok("from"in e,'Params must include a "from" field.'),p().ok("string"==typeof e.from&&(0,d.isValidAddress)(e.from),'"from" field must be a valid, lowercase, hexadecimal Ethereum address string.');let n=null,i=null;switch(e.version){case u.SignTypedDataVersion.V1:"string"==typeof e.data?p().doesNotThrow(()=>{n=JSON.parse(e.data)},'"data" must be a valid JSON string.'):n=e.data,p().ok(Array.isArray(n),"params.data must be an array."),p().doesNotThrow(()=>{(0,u.typedSignatureHash)(n)},"Signing data must be valid EIP-712 typed data.");break;case u.SignTypedDataVersion.V3:case u.SignTypedDataVersion.V4:"string"==typeof e.data?p().doesNotThrow(()=>{n=JSON.parse(e.data)},'"data" must be a valid JSON string.'):n=e.data,p().ok(n.primaryType in n.types,`Primary type of "${n.primaryType}" has no type definition.`);let a=g.validate(n,u.TYPED_MESSAGE_SCHEMA.properties);p().strictEqual(a.errors.length,0,"Signing data must conform to EIP-712 schema. See https://git.io/fNtcx."),(i=null===(t=n.domain)||void 0===t?void 0:t.chainId)&&(p().ok(!Number.isNaN(r),`Cannot sign messages for chainId "${i}", because Web3Auth is switching networks.`),"string"==typeof i&&(i=Number.parseInt(i,(0,o.H2)(i)?16:10)),p().strictEqual(i,r,`Provided chainId "${i}" must match the active chainId "${r}"`));break;default:p().fail(`Unknown typed data version "${e.version}"`)}}catch(s){throw c.ethErrors.rpc.invalidInput({message:null==s?void 0:s.message})}};function z(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function Z(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?z(Object(t),!0).forEach(function(r){(0,n.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):z(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}async function q(e,r,t){let n=await t.formatTransaction(e),i=await t.getCommonConfiguration(),a=f.TransactionFactory.fromTxData(n,{common:i}),o=a.sign(P.from(r,"hex")).serialize();return o}function $(e){let{txFormatter:r,privKey:t,getProviderEngineProxy:n}=e;return{getAccounts:async e=>[`0x${(0,d.privateToAddress)(P.from(t,"hex")).toString("hex")}`],getPrivateKey:async e=>t,async processTransaction(e,i){let a=n();if(!a)throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});let o=await q(e,t,r),s=await a.request({method:"eth_sendRawTransaction",params:["0x".concat(o.toString("hex"))]});return s},async processSignTransaction(e,i){let a=n();if(!a)throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});let o=await q(e,t,r);return`0x${o.toString("hex")}`},async processEthSignMessage(e,r){let n=(0,i.l)(t,e.data);return n},async processPersonalMessage(e,r){let n=P.from(t,"hex"),i=(0,u.personalSign)({privateKey:n,data:e.data});return i},async processTypedMessage(e,r){o.cM.debug("processTypedMessage",e);let i=P.from(t,"hex"),a=n();if(!a)throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});let s=await a.request({method:"eth_chainId"}),f=Number.parseInt(s,(0,o.H2)(s)?16:10),d=Z(Z({},e),{},{version:u.SignTypedDataVersion.V1});V(d,f);let l="string"==typeof d.data?JSON.parse(d.data):d.data,h=(0,u.signTypedData)({privateKey:i,data:l,version:u.SignTypedDataVersion.V1});return h},async processTypedMessageV3(e,r){o.cM.debug("processTypedMessageV3",e);let i=P.from(t,"hex"),a=n();if(!a)throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});let s=await a.request({method:"eth_chainId"}),f=Number.parseInt(s,(0,o.H2)(s)?16:10);V(e,f);let d="string"==typeof e.data?JSON.parse(e.data):e.data,l=(0,u.signTypedData)({privateKey:i,data:d,version:u.SignTypedDataVersion.V3});return l},async processTypedMessageV4(e,r){o.cM.debug("processTypedMessageV4",e);let i=P.from(t,"hex"),a=n();if(!a)throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});let s=await a.request({method:"eth_chainId"}),f=Number.parseInt(s,(0,o.H2)(s)?16:10);V(e,f);let d="string"==typeof e.data?JSON.parse(e.data):e.data,l=(0,u.signTypedData)({privateKey:i,data:d,version:u.SignTypedDataVersion.V4});return l},processEncryptionPublicKey:async(e,r)=>(o.cM.info("processEncryptionPublicKey",e),(0,u.getEncryptionPublicKey)(t)),processDecryptMessage(e,r){o.cM.info("processDecryptMessage",e);let n=(0,d.stripHexPrefix)(e.data),i=P.from(n,"hex"),a=(0,u.decrypt)({encryptedData:JSON.parse(i.toString("utf8")),privateKey:t});return a}}}function W(e){return(0,d.addHexPrefix)(e.toString(16))}function J(e){return d.BN.isBN(e)?e:new d.BN((0,d.stripHexPrefix)(e),16)}let Y={LEGACY:"0x0",ACCESS_LIST:"0x1",FEE_MARKET:"0x2"},X={SENT_ETHER:"sentEther",CONTRACT_INTERACTION:"contractInteraction",DEPLOY_CONTRACT:"contractDeployment",STANDARD_TRANSACTION:"transaction"},Q={FEE_MARKET:"fee-market",LEGACY:"legacy",ETH_GASPRICE:"eth_gasPrice",NONE:"none"};function ee(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function er(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ee(Object(t),!0).forEach(function(r){(0,n.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ee(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}class et{constructor(e){let{getProviderEngineProxy:r}=e;(0,n.Z)(this,"chainConfig",null),(0,n.Z)(this,"getProviderEngineProxy",void 0),(0,n.Z)(this,"isEIP1559Compatible",!1),this.getProviderEngineProxy=r}get providerProxy(){return this.getProviderEngineProxy()}async init(){this.chainConfig=await this.providerProxy.request({method:"eth_provider_config",params:[]}),this.isEIP1559Compatible=await this.getEIP1559Compatibility()}async getCommonConfiguration(){if(!this.chainConfig)throw Error("Chain config not initialized");let{displayName:e,chainId:r}=this.chainConfig,t=this.isEIP1559Compatible?m.Hardfork.London:m.Hardfork.Berlin,n={name:e,chainId:"loading"===r?0:Number.parseInt(r,16),networkId:"loading"===r?0:Number.parseInt(r,16),defaultHardfork:t};return v().custom(n)}async formatTransaction(e){if(!this.chainConfig)throw Error("Chain config not initialized");let r=er({},e);if(void 0===r.nonce&&(r.nonce=await this.providerProxy.request({method:"eth_getTransactionCount",params:[e.from,"latest"]})),!this.isEIP1559Compatible&&r.gasPrice){if(r.maxFeePerGas&&delete r.maxFeePerGas,r.maxPriorityFeePerGas&&delete r.maxPriorityFeePerGas,r.gas)r.gasLimit=r.gas;else{let t=await this.getDefaultGasLimit(r);t&&(r.gasLimit=t)}return r}if(r.gas)r.gasLimit=r.gas;else{let n=await this.getDefaultGasLimit(r);n&&(r.gasLimit=n)}let{gasPrice:i,maxFeePerGas:a,maxPriorityFeePerGas:o}=await this.getDefaultGasFees(r);if(this.isEIP1559Compatible){if(!r.gasPrice||r.maxFeePerGas||r.maxPriorityFeePerGas)a&&!r.maxFeePerGas&&(r.maxFeePerGas=a),o&&!r.maxPriorityFeePerGas&&(r.maxPriorityFeePerGas=o),i&&!r.maxFeePerGas&&(r.maxFeePerGas=i),r.maxFeePerGas&&!r.maxPriorityFeePerGas&&(r.maxPriorityFeePerGas=r.maxFeePerGas);else{var s,c;r.maxFeePerGas=r.gasPrice,s="string"==typeof o?(0,d.stripHexPrefix)(o):o,c="string"==typeof r.gasPrice?(0,d.stripHexPrefix)(r.gasPrice):r.gasPrice,r.maxPriorityFeePerGas=(null==s||null==c?null:new y.O(s,10).lt(c,10))?o:r.gasPrice}delete r.gasPrice}else delete r.maxPriorityFeePerGas,delete r.maxFeePerGas;return!i||r.gasPrice||r.maxPriorityFeePerGas||r.maxFeePerGas||(r.gasPrice=i),r.type=this.isEIP1559Compatible?Y.FEE_MARKET:Y.LEGACY,r.chainId=this.chainConfig.chainId,r}async fetchEthGasPriceEstimate(){let e=await this.providerProxy.request({method:"eth_gasPrice",params:[]});return{gasPrice:F(e).toString()}}async getEIP1559Compatibility(){let e=await this.providerProxy.request({method:"eth_getBlockByNumber",params:["latest",!1]}),r=e&&void 0!==e.baseFeePerGas;return!!r}async fetchGasFeeEstimateData(){if(!this.chainConfig)throw Error("Chain config not initialized");let e="0x1"===this.chainConfig.chainId,r=Number.parseInt(this.chainConfig.chainId,16),t;try{if(this.isEIP1559Compatible){let n=await R("https://gas-api.metaswap.codefi.network/networks/<chain_id>/suggestedGasFees".replace("<chain_id>",`${r}`));t={gasFeeEstimates:n,gasEstimateType:Q.FEE_MARKET}}else if(e){let i=await U("https://gas-api.metaswap.codefi.network/networks/<chain_id>/gasPrices".replace("<chain_id>",`${r}`));t={gasFeeEstimates:i,gasEstimateType:Q.LEGACY}}else throw Error("Main gas fee/price estimation failed. Use fallback")}catch(s){try{let a=await this.fetchEthGasPriceEstimate();t={gasFeeEstimates:a,gasEstimateType:Q.ETH_GASPRICE}}catch(o){throw Error(`Gas fee/price estimation failed. Message: ${o.message}`)}}return t}async getDefaultGasFees(e){if(!this.isEIP1559Compatible&&e.gasPrice||this.isEIP1559Compatible&&e.maxFeePerGas&&e.maxPriorityFeePerGas)return{};try{let{gasFeeEstimates:r,gasEstimateType:t}=await this.fetchGasFeeEstimateData();if(this.isEIP1559Compatible&&t===Q.FEE_MARKET){let{medium:{suggestedMaxPriorityFeePerGas:n,suggestedMaxFeePerGas:i}={}}=r;if(n&&i)return{maxFeePerGas:(0,d.addHexPrefix)(G(i)),maxPriorityFeePerGas:(0,d.addHexPrefix)(G(n))}}else if(t===Q.LEGACY)return{gasPrice:(0,d.addHexPrefix)(G(r.medium))};else if(t===Q.ETH_GASPRICE)return{gasPrice:(0,d.addHexPrefix)(G(r.gasPrice))}}catch(a){o.cM.error(a)}let{gasPrice:s}=await this.fetchEthGasPriceEstimate();return{gasPrice:(0,d.addHexPrefix)(G(s))}}async estimateTxGas(e){let r=er({},e);delete r.gasPrice,delete r.maxFeePerGas,delete r.maxPriorityFeePerGas;let t=await this.providerProxy.request({method:"eth_estimateGas",params:[r]});return t}async analyzeGasUsage(e){let r=await this.providerProxy.request({method:"eth_getBlockByNumber",params:["latest",!1]}),t=J(r.gasLimit),n=function(e,r,t){let n=new d.BN(19),i=new d.BN(20);return e.mul(n).div(i)}(t,19,20),i=W(n);try{i=await this.estimateTxGas(e)}catch(a){o.cM.warn(a)}return{blockGasLimit:r.gasLimit,estimatedGasHex:i}}addGasBuffer(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1.5,n=J(e),i=J(r),a=i.muln(.9),o=n.muln(t);return n.gt(a)?W(n):o.lt(a)?W(o):W(a)}async determineTransactionCategory(e){let{data:r,to:t}=e,n="",i;if(r&&!t)i=X.DEPLOY_CONTRACT;else{try{n=await this.providerProxy.request({method:"eth_getCode",params:[t,"latest"]})}catch(a){o.cM.warn(a)}let s=!n||"0x"===n||"0x0"===n;i=s?X.SENT_ETHER:X.CONTRACT_INTERACTION}return{transactionCategory:i,code:n}}async getDefaultGasLimit(e){let{transactionCategory:r}=await this.determineTransactionCategory(er({},e));if(e.gas)return e.gas;if(e.to&&r===X.SENT_ETHER){if(e.data)throw Error("TxGasUtil - Trying to call a function on a non-contract address");return(0,d.addHexPrefix)(21e3.toString(16))}let{blockGasLimit:t,estimatedGasHex:n}=await this.analyzeGasUsage(e),i=this.addGasBuffer((0,d.addHexPrefix)(n),t);return i}}function en(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function ei(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?en(Object(t),!0).forEach(function(r){(0,n.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):en(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}class ea extends s.Zk{constructor(e){let{config:r,state:t}=e;super({config:{chainConfig:ei(ei({},r.chainConfig),{},{chainNamespace:o.EN.EIP155})},state:t})}async enable(){if(!this.state.privateKey)throw c.ethErrors.provider.custom({message:"Private key is not found in state, plz pass it in constructor state param",code:4902});return await this.setupProvider(this.state.privateKey),this._providerEngineProxy.request({method:"eth_accounts"})}async setupProvider(e){let r=new et({getProviderEngineProxy:this.getProviderEngineProxy.bind(this)}),t=$({txFormatter:r,privKey:e,getProviderEngineProxy:this.getProviderEngineProxy.bind(this)}),n=x(t),o=this.getChainSwitchMiddleware(),s=new a.eI,{networkMiddleware:c}=_(this.config.chainConfig);s.push(n),s.push(o),s.push(this.getAccountMiddleware()),s.push(c);let f=(0,i.Xj)(s);this.updateProviderEngineProxy(f),await r.init(),await this.lookupNetwork()}async updateAccount(e){if(!this._providerEngineProxy)throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});let r=await this._providerEngineProxy.request({method:"eth_private_key"});r!==e.privateKey&&(await this.setupProvider(e.privateKey),this._providerEngineProxy.emit("accountsChanged",{accounts:await this._providerEngineProxy.request({method:"eth_accounts"})}))}async switchChain(e){if(!this._providerEngineProxy)throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});let r=this.getChainConfig(e.chainId);this.update({chainId:"loading"}),this.configure({chainConfig:r});let t=await this._providerEngineProxy.request({method:"eth_private_key"});await this.setupProvider(t)}async lookupNetwork(){if(!this._providerEngineProxy)throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});let{chainId:e}=this.config.chainConfig;if(!e)throw c.ethErrors.rpc.invalidParams("chainId is required while lookupNetwork");let r=await this._providerEngineProxy.request({method:"net_version",params:[]});if(parseInt(e,16)!==parseInt(r,10))throw c.ethErrors.provider.chainDisconnected(`Invalid network, net_version is: ${r}`);return this.state.chainId!==e&&(this._providerEngineProxy.emit("chainChanged",e),this._providerEngineProxy.emit("connect",{chainId:e})),this.update({chainId:e}),r}getChainSwitchMiddleware(){let e=function(e){let{addChain:r,switchChain:t}=e;async function n(e,t){var n;let i=null!==(n=e.params)&&void 0!==n&&n.length?e.params[0]:void 0;if(!i)throw c.ethErrors.rpc.invalidParams("Missing chain params");if(!i.chainId)throw c.ethErrors.rpc.invalidParams("Missing chainId in chainParams");if(!i.rpcUrls||0===i.rpcUrls.length)throw c.ethErrors.rpc.invalidParams("Missing rpcUrls in chainParams");if(!i.nativeCurrency)throw c.ethErrors.rpc.invalidParams("Missing nativeCurrency in chainParams");t.result=await r(i)}async function i(e,r){var n;let i=null!==(n=e.params)&&void 0!==n&&n.length?e.params[0]:void 0;if(!i)throw c.ethErrors.rpc.invalidParams("Missing chainId");r.result=await t(i)}return(0,a.v0)({wallet_addEthereumChain:(0,a.Pk)(n),wallet_switchEthereumChain:(0,a.Pk)(i)})}({addChain:async e=>{let{chainId:r,chainName:t,rpcUrls:n,blockExplorerUrls:i,nativeCurrency:a}=e;this.addChain({chainNamespace:"eip155",chainId:r,ticker:(null==a?void 0:a.symbol)||"ETH",tickerName:(null==a?void 0:a.name)||"Ether",displayName:t,rpcTarget:n[0],blockExplorer:(null==i?void 0:i[0])||""})},switchChain:async e=>{let{chainId:r}=e;await this.switchChain({chainId:r})}});return e}getAccountMiddleware(){return function(e){let{updatePrivatekey:r}=e;async function t(e,t){var n;let i=null!==(n=e.params)&&void 0!==n&&n.length?e.params[0]:void 0;if(!(null!=i&&i.privateKey))throw c.ethErrors.rpc.invalidParams("Missing privateKey");t.result=await r(i)}return(0,a.v0)({wallet_updateAccount:(0,a.Pk)(t)})}({updatePrivatekey:async e=>{let{privateKey:r}=e;await this.updateAccount({privateKey:r})}})}}(0,n.Z)(ea,"getProviderInstance",async e=>{let r=new ea({config:{chainConfig:e.chainConfig}});return await r.setupProvider(e.privKey),r})},46114:function(e,r,t){var n=t(48764).Buffer,i=this&&this.__read||function(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,i,a=t.call(e),o=[];try{for(;(void 0===r||r-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(i)throw i.error}}return o},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.isZeroAddress=r.zeroAddress=r.importPublic=r.privateToAddress=r.privateToPublic=r.publicToAddress=r.pubToAddress=r.isValidPublic=r.isValidPrivate=r.generateAddress2=r.generateAddress=r.isValidChecksumAddress=r.toChecksumAddress=r.isValidAddress=r.Account=void 0;var o=a(t(69282)),s=t(50523),c=t(95053),f=t(60571),u=t(16397),d=t(47107),l=t(91207),h=t(3323),p=t(89260),g=function(){function e(e,r,t,n){void 0===e&&(e=new s.BN(0)),void 0===r&&(r=new s.BN(0)),void 0===t&&(t=u.KECCAK256_RLP),void 0===n&&(n=u.KECCAK256_NULL),this.nonce=e,this.balance=r,this.stateRoot=t,this.codeHash=n,this._validate()}return e.fromAccountData=function(r){var t=r.nonce,n=r.balance,i=r.stateRoot,a=r.codeHash;return new e(t?new s.BN((0,d.toBuffer)(t)):void 0,n?new s.BN((0,d.toBuffer)(n)):void 0,i?(0,d.toBuffer)(i):void 0,a?(0,d.toBuffer)(a):void 0)},e.fromRlpSerializedAccount=function(e){var r=s.rlp.decode(e);if(!Array.isArray(r))throw Error("Invalid serialized account input. Must be array");return this.fromValuesArray(r)},e.fromValuesArray=function(r){var t=i(r,4),n=t[0],a=t[1],o=t[2],c=t[3];return new e(new s.BN(n),new s.BN(a),o,c)},e.prototype._validate=function(){if(this.nonce.lt(new s.BN(0)))throw Error("nonce must be greater than zero");if(this.balance.lt(new s.BN(0)))throw Error("balance must be greater than zero");if(32!==this.stateRoot.length)throw Error("stateRoot must have a length of 32");if(32!==this.codeHash.length)throw Error("codeHash must have a length of 32")},e.prototype.raw=function(){return[(0,p.bnToUnpaddedBuffer)(this.nonce),(0,p.bnToUnpaddedBuffer)(this.balance),this.stateRoot,this.codeHash,]},e.prototype.serialize=function(){return s.rlp.encode(this.raw())},e.prototype.isContract=function(){return!this.codeHash.equals(u.KECCAK256_NULL)},e.prototype.isEmpty=function(){return this.balance.isZero()&&this.nonce.isZero()&&this.codeHash.equals(u.KECCAK256_NULL)},e}();r.Account=g;var y=function(e){try{(0,h.assertIsString)(e)}catch(r){return!1}return/^0x[0-9a-fA-F]{40}$/.test(e)};r.isValidAddress=y;var m=function(e,r){(0,h.assertIsHexString)(e);var t=(0,f.stripHexPrefix)(e).toLowerCase(),n="";r&&(n=(0,p.toType)(r,p.TypeOutput.BN).toString()+"0x");for(var i=(0,l.keccakFromString)(n+t).toString("hex"),a="0x",o=0;o<t.length;o++)parseInt(i[o],16)>=8?a+=t[o].toUpperCase():a+=t[o];return a};r.toChecksumAddress=m;var v=function(e,t){return(0,r.isValidAddress)(e)&&(0,r.toChecksumAddress)(e,t)===e};r.isValidChecksumAddress=v;var P=function(e,r){(0,h.assertIsBuffer)(e),(0,h.assertIsBuffer)(r);var t=new s.BN(r);return t.isZero()?(0,l.rlphash)([e,null]).slice(-20):(0,l.rlphash)([e,n.from(t.toArray())]).slice(-20)};r.generateAddress=P;var w=function(e,r,t){return(0,h.assertIsBuffer)(e),(0,h.assertIsBuffer)(r),(0,h.assertIsBuffer)(t),(0,o.default)(20===e.length),(0,o.default)(32===r.length),(0,l.keccak256)(n.concat([n.from("ff","hex"),e,r,(0,l.keccak256)(t)])).slice(-20)};r.generateAddress2=w;var b=function(e){return(0,c.privateKeyVerify)(e)};r.isValidPrivate=b;var E=function(e,r){return(void 0===r&&(r=!1),(0,h.assertIsBuffer)(e),64===e.length)?(0,c.publicKeyVerify)(n.concat([n.from([4]),e])):!!r&&(0,c.publicKeyVerify)(e)};r.isValidPublic=E;var x=function(e,r){return void 0===r&&(r=!1),(0,h.assertIsBuffer)(e),r&&64!==e.length&&(e=n.from((0,c.publicKeyConvert)(e,!1).slice(1))),(0,o.default)(64===e.length),(0,l.keccak)(e).slice(-20)};r.pubToAddress=x,r.publicToAddress=r.pubToAddress;var _=function(e){return(0,h.assertIsBuffer)(e),n.from((0,c.publicKeyCreate)(e,!1)).slice(1)};r.privateToPublic=_;var A=function(e){return(0,r.publicToAddress)((0,r.privateToPublic)(e))};r.privateToAddress=A;var O=function(e){return(0,h.assertIsBuffer)(e),64!==e.length&&(e=n.from((0,c.publicKeyConvert)(e,!1).slice(1))),e};r.importPublic=O;var T=function(){var e=(0,d.zeros)(20);return(0,d.bufferToHex)(e)};r.zeroAddress=T;var S=function(e){try{(0,h.assertIsString)(e)}catch(t){return!1}return(0,r.zeroAddress)()===e};r.isZeroAddress=S},75770:function(e,r,t){var n=t(48764).Buffer,i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.Address=void 0;var a=i(t(69282)),o=t(50523),s=t(47107),c=t(46114),f=function(){function e(e){(0,a.default)(20===e.length,"Invalid address length"),this.buf=e}return e.zero=function(){return new e((0,s.zeros)(20))},e.fromString=function(r){return(0,a.default)((0,c.isValidAddress)(r),"Invalid address"),new e((0,s.toBuffer)(r))},e.fromPublicKey=function(r){(0,a.default)(n.isBuffer(r),"Public key should be Buffer");var t=(0,c.pubToAddress)(r);return new e(t)},e.fromPrivateKey=function(r){(0,a.default)(n.isBuffer(r),"Private key should be Buffer");var t=(0,c.privateToAddress)(r);return new e(t)},e.generate=function(r,t){return(0,a.default)(o.BN.isBN(t)),new e((0,c.generateAddress)(r.buf,t.toArrayLike(n)))},e.generate2=function(r,t,i){return(0,a.default)(n.isBuffer(t)),(0,a.default)(n.isBuffer(i)),new e((0,c.generateAddress2)(r.buf,t,i))},e.prototype.equals=function(e){return this.buf.equals(e.buf)},e.prototype.isZero=function(){return this.equals(e.zero())},e.prototype.isPrecompileOrSystemAddress=function(){var e=new o.BN(this.buf),r=new o.BN(0),t=new o.BN("ffff","hex");return e.gte(r)&&e.lte(t)},e.prototype.toString=function(){return"0x"+this.buf.toString("hex")},e.prototype.toBuffer=function(){return n.from(this.buf)},e}();r.Address=f},47107:function(e,r,t){var n=t(48764).Buffer,i=this&&this.__values||function(e){var r="function"==typeof Symbol&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,i,a=t.call(e),o=[];try{for(;(void 0===r||r-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(i)throw i.error}}return o};Object.defineProperty(r,"__esModule",{value:!0}),r.bufArrToArr=r.arrToBufArr=r.validateNoLeadingZeroes=r.baToJSON=r.toUtf8=r.addHexPrefix=r.toUnsigned=r.fromSigned=r.bufferToHex=r.bufferToInt=r.toBuffer=r.unpadHexString=r.unpadArray=r.unpadBuffer=r.setLengthRight=r.setLengthLeft=r.zeros=r.intToBuffer=r.intToHex=void 0;var o=t(50523),s=t(60571),c=t(3323),f=function(e){if(!Number.isSafeInteger(e)||e<0)throw Error("Received an invalid integer type: ".concat(e));return"0x".concat(e.toString(16))};r.intToHex=f;var u=function(e){var t=(0,r.intToHex)(e);return n.from((0,s.padToEven)(t.slice(2)),"hex")};r.intToBuffer=u;var d=function(e){return n.allocUnsafe(e).fill(0)};r.zeros=d;var l=function(e,t,n){var i=(0,r.zeros)(t);return n?e.length<t?(e.copy(i),i):e.slice(0,t):e.length<t?(e.copy(i,t-e.length),i):e.slice(-t)},h=function(e,r){return(0,c.assertIsBuffer)(e),l(e,r,!1)};r.setLengthLeft=h;var p=function(e,r){return(0,c.assertIsBuffer)(e),l(e,r,!0)};r.setLengthRight=p;var g=function(e){for(var r=e[0];e.length>0&&"0"===r.toString();)r=(e=e.slice(1))[0];return e},y=function(e){return(0,c.assertIsBuffer)(e),g(e)};r.unpadBuffer=y;var m=function(e){return(0,c.assertIsArray)(e),g(e)};r.unpadArray=m;var v=function(e){return(0,c.assertIsHexString)(e),g(e=(0,s.stripHexPrefix)(e))};r.unpadHexString=v;var P=function(e){if(null==e)return n.allocUnsafe(0);if(n.isBuffer(e)||Array.isArray(e)||e instanceof Uint8Array)return n.from(e);if("string"==typeof e){if(!(0,s.isHexString)(e))throw Error("Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: ".concat(e));return n.from((0,s.padToEven)((0,s.stripHexPrefix)(e)),"hex")}if("number"==typeof e)return(0,r.intToBuffer)(e);if(o.BN.isBN(e)){if(e.isNeg())throw Error("Cannot convert negative BN to buffer. Given: ".concat(e));return e.toArrayLike(n)}if(e.toArray)return n.from(e.toArray());if(e.toBuffer)return n.from(e.toBuffer());throw Error("invalid type")};r.toBuffer=P;var w=function(e){return new o.BN((0,r.toBuffer)(e)).toNumber()};r.bufferToInt=w;var b=function(e){return"0x"+(e=(0,r.toBuffer)(e)).toString("hex")};r.bufferToHex=b;var E=function(e){return new o.BN(e).fromTwos(256)};r.fromSigned=E;var x=function(e){return n.from(e.toTwos(256).toArray())};r.toUnsigned=x;var _=function(e){return"string"!=typeof e?e:(0,s.isHexPrefixed)(e)?e:"0x"+e};r.addHexPrefix=_;var A=function(e){if((e=(0,s.stripHexPrefix)(e)).length%2!=0)throw Error("Invalid non-even hex string input for toUtf8() provided");return n.from(e.replace(/^(00)+|(00)+$/g,""),"hex").toString("utf8")};r.toUtf8=A;var O=function(e){if(n.isBuffer(e))return"0x".concat(e.toString("hex"));if(e instanceof Array){for(var t=[],i=0;i<e.length;i++)t.push((0,r.baToJSON)(e[i]));return t}};r.baToJSON=O;var T=function(e){var r,t;try{for(var n=i(Object.entries(e)),o=n.next();!o.done;o=n.next()){var s=a(o.value,2),c=s[0],f=s[1];if(void 0!==f&&f.length>0&&0===f[0])throw Error("".concat(c," cannot have leading zeroes, received: ").concat(f.toString("hex")))}}catch(u){r={error:u}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(r)throw r.error}}};r.validateNoLeadingZeroes=T,r.arrToBufArr=function e(r){return Array.isArray(r)?r.map(function(r){return e(r)}):n.from(r)},r.bufArrToArr=function e(r){return Array.isArray(r)?r.map(function(r){return e(r)}):Uint8Array.from(null!=r?r:[])}},16397:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.KECCAK256_RLP=r.KECCAK256_RLP_S=r.KECCAK256_RLP_ARRAY=r.KECCAK256_RLP_ARRAY_S=r.KECCAK256_NULL=r.KECCAK256_NULL_S=r.TWO_POW256=r.MAX_INTEGER=r.MAX_UINT64=void 0;var n=t(48764),i=t(50523);r.MAX_UINT64=new i.BN("ffffffffffffffff",16),r.MAX_INTEGER=new i.BN("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),r.TWO_POW256=new i.BN("10000000000000000000000000000000000000000000000000000000000000000",16),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.KECCAK256_NULL=n.Buffer.from(r.KECCAK256_NULL_S,"hex"),r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.KECCAK256_RLP_ARRAY=n.Buffer.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.KECCAK256_RLP=n.Buffer.from(r.KECCAK256_RLP_S,"hex")},50523:function(e,r,t){var n=this&&this.__createBinding||(Object.create?function(e,r,t,n){void 0===n&&(n=t);var i=Object.getOwnPropertyDescriptor(r,t);(!i||("get"in i?!r.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,n,i)}:function(e,r,t,n){void 0===n&&(n=t),e[n]=r[t]}),i=this&&this.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&n(r,e,t);return i(r,e),r},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.rlp=r.BN=void 0;var s=o(t(13550));r.BN=s.default;var c=a(t(51675));r.rlp=c},91207:function(e,r,t){var n=t(48764).Buffer;Object.defineProperty(r,"__esModule",{value:!0}),r.rlphash=r.ripemd160FromArray=r.ripemd160FromString=r.ripemd160=r.sha256FromArray=r.sha256FromString=r.sha256=r.keccakFromArray=r.keccakFromHexString=r.keccakFromString=r.keccak256=r.keccak=void 0;var i=t(82192),a=t(23482),o=t(50523),s=t(47107),c=t(3323),f=function(e,r){switch(void 0===r&&(r=256),(0,c.assertIsBuffer)(e),r){case 224:return(0,i.keccak224)(e);case 256:return(0,i.keccak256)(e);case 384:return(0,i.keccak384)(e);case 512:return(0,i.keccak512)(e);default:throw Error("Invald algorithm: keccak".concat(r))}};r.keccak=f;var u=function(e){return(0,r.keccak)(e)};r.keccak256=u;var d=function(e,t){void 0===t&&(t=256),(0,c.assertIsString)(e);var i=n.from(e,"utf8");return(0,r.keccak)(i,t)};r.keccakFromString=d;var l=function(e,t){return void 0===t&&(t=256),(0,c.assertIsHexString)(e),(0,r.keccak)((0,s.toBuffer)(e),t)};r.keccakFromHexString=l;var h=function(e,t){return void 0===t&&(t=256),(0,c.assertIsArray)(e),(0,r.keccak)((0,s.toBuffer)(e),t)};r.keccakFromArray=h;var p=function(e){return e=(0,s.toBuffer)(e),a("sha256").update(e).digest()},g=function(e){return(0,c.assertIsBuffer)(e),p(e)};r.sha256=g;var y=function(e){return(0,c.assertIsString)(e),p(e)};r.sha256FromString=y;var m=function(e){return(0,c.assertIsArray)(e),p(e)};r.sha256FromArray=m;var v=function(e,r){e=(0,s.toBuffer)(e);var t=a("rmd160").update(e).digest();return!0===r?(0,s.setLengthLeft)(t,32):t},P=function(e,r){return(0,c.assertIsBuffer)(e),v(e,r)};r.ripemd160=P;var w=function(e,r){return(0,c.assertIsString)(e),v(e,r)};r.ripemd160FromString=w;var b=function(e,r){return(0,c.assertIsArray)(e),v(e,r)};r.ripemd160FromArray=b;var E=function(e){return(0,r.keccak)(o.rlp.encode(e))};r.rlphash=E},3323:function(e,r,t){var n=t(48764).Buffer;Object.defineProperty(r,"__esModule",{value:!0}),r.assertIsString=r.assertIsArray=r.assertIsBuffer=r.assertIsHexString=void 0;var i=t(60571),a=function(e){if(!(0,i.isHexString)(e))throw Error("This method only supports 0x-prefixed hex strings but input was: ".concat(e))};r.assertIsHexString=a;var o=function(e){if(!n.isBuffer(e))throw Error("This method only supports Buffer but input was: ".concat(e))};r.assertIsBuffer=o;var s=function(e){if(!Array.isArray(e))throw Error("This method only supports number arrays but input was: ".concat(e))};r.assertIsArray=s;var c=function(e){if("string"!=typeof e)throw Error("This method only supports strings but input was: ".concat(e))};r.assertIsString=c},53934:function(e,r,t){var n=this&&this.__createBinding||(Object.create?function(e,r,t,n){void 0===n&&(n=t);var i=Object.getOwnPropertyDescriptor(r,t);(!i||("get"in i?!r.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,n,i)}:function(e,r,t,n){void 0===n&&(n=t),e[n]=r[t]}),i=this&&this.__exportStar||function(e,r){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(r,t)||n(r,e,t)};Object.defineProperty(r,"__esModule",{value:!0}),r.isHexString=r.getKeys=r.fromAscii=r.fromUtf8=r.toAscii=r.arrayContainsArray=r.getBinarySize=r.padToEven=r.stripHexPrefix=r.isHexPrefixed=void 0,i(t(16397),r),i(t(46114),r),i(t(75770),r),i(t(91207),r),i(t(3077),r),i(t(47107),r),i(t(9211),r),i(t(50523),r),i(t(89260),r);var a=t(60571);Object.defineProperty(r,"isHexPrefixed",{enumerable:!0,get:function(){return a.isHexPrefixed}}),Object.defineProperty(r,"stripHexPrefix",{enumerable:!0,get:function(){return a.stripHexPrefix}}),Object.defineProperty(r,"padToEven",{enumerable:!0,get:function(){return a.padToEven}}),Object.defineProperty(r,"getBinarySize",{enumerable:!0,get:function(){return a.getBinarySize}}),Object.defineProperty(r,"arrayContainsArray",{enumerable:!0,get:function(){return a.arrayContainsArray}}),Object.defineProperty(r,"toAscii",{enumerable:!0,get:function(){return a.toAscii}}),Object.defineProperty(r,"fromUtf8",{enumerable:!0,get:function(){return a.fromUtf8}}),Object.defineProperty(r,"fromAscii",{enumerable:!0,get:function(){return a.fromAscii}}),Object.defineProperty(r,"getKeys",{enumerable:!0,get:function(){return a.getKeys}}),Object.defineProperty(r,"isHexString",{enumerable:!0,get:function(){return a.isHexString}})},60571:function(e,r,t){var n=t(48764).Buffer;function i(e){if("string"!=typeof e)throw Error("[isHexPrefixed] input must be type 'string', received type ".concat(typeof e));return"0"===e[0]&&"x"===e[1]}Object.defineProperty(r,"__esModule",{value:!0}),r.isHexString=r.getKeys=r.fromAscii=r.fromUtf8=r.toAscii=r.arrayContainsArray=r.getBinarySize=r.padToEven=r.stripHexPrefix=r.isHexPrefixed=void 0,r.isHexPrefixed=i;var a=function(e){if("string"!=typeof e)throw Error("[stripHexPrefix] input must be type 'string', received ".concat(typeof e));return i(e)?e.slice(2):e};function o(e){var r=e;if("string"!=typeof r)throw Error("[padToEven] value must be type 'string', received ".concat(typeof r));return r.length%2&&(r="0".concat(r)),r}r.stripHexPrefix=a,r.padToEven=o,r.getBinarySize=function(e){if("string"!=typeof e)throw Error("[getBinarySize] method requires input type 'string', recieved ".concat(typeof e));return n.byteLength(e,"utf8")},r.arrayContainsArray=function(e,r,t){if(!0!==Array.isArray(e))throw Error("[arrayContainsArray] method requires input 'superset' to be an array, got type '".concat(typeof e,"'"));if(!0!==Array.isArray(r))throw Error("[arrayContainsArray] method requires input 'subset' to be an array, got type '".concat(typeof r,"'"));return r[t?"some":"every"](function(r){return e.indexOf(r)>=0})},r.toAscii=function(e){var r="",t=0,n=e.length;for("0x"===e.substring(0,2)&&(t=2);t<n;t+=2)r+=String.fromCharCode(parseInt(e.substr(t,2),16));return r},r.fromUtf8=function(e){var r=n.from(e,"utf8");return"0x".concat(o(r.toString("hex")).replace(/^0+|0+$/g,""))},r.fromAscii=function(e){for(var r="",t=0;t<e.length;t++){var n=e.charCodeAt(t).toString(16);r+=n.length<2?"0".concat(n):n}return"0x".concat(r)},r.getKeys=function(e,r,t){if(!Array.isArray(e))throw Error("[getKeys] method expects input 'params' to be an array, got ".concat(typeof e));if("string"!=typeof r)throw Error("[getKeys] method expects input 'key' to be type 'string', got ".concat(typeof e));for(var n=[],i=0;i<e.length;i++){var a=e[i][r];if(t&&!a)a="";else if("string"!=typeof a)throw Error("invalid abi - expected type 'string', received ".concat(typeof a));n.push(a)}return n},r.isHexString=function(e,r){return"string"==typeof e&&!!e.match(/^0x[0-9A-Fa-f]*$/)&&(!r||e.length===2+2*r)}},9211:function(e,r,t){var n=t(48764).Buffer,i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.defineProperties=void 0;var a=i(t(69282)),o=t(60571),s=t(50523),c=t(47107),f=function(e,r,t){if(e.raw=[],e._fields=[],e.toJSON=function(r){if(void 0===r&&(r=!1),r){var t={};return e._fields.forEach(function(r){t[r]="0x".concat(e[r].toString("hex"))}),t}return(0,c.baToJSON)(e.raw)},e.serialize=function(){return s.rlp.encode(e.raw)},r.forEach(function(r,t){function i(){return e.raw[t]}function o(i){"00"!==(i=(0,c.toBuffer)(i)).toString("hex")||r.allowZero||(i=n.allocUnsafe(0)),r.allowLess&&r.length?(i=(0,c.unpadBuffer)(i),(0,a.default)(r.length>=i.length,"The field ".concat(r.name," must not have more ").concat(r.length," bytes"))):!(r.allowZero&&0===i.length)&&r.length&&(0,a.default)(r.length===i.length,"The field ".concat(r.name," must have byte length of ").concat(r.length)),e.raw[t]=i}e._fields.push(r.name),Object.defineProperty(e,r.name,{enumerable:!0,configurable:!0,get:i,set:o}),r.default&&(e[r.name]=r.default),r.alias&&Object.defineProperty(e,r.alias,{enumerable:!1,configurable:!0,set:o,get:i})}),t){if("string"==typeof t&&(t=n.from((0,o.stripHexPrefix)(t),"hex")),n.isBuffer(t)&&(t=s.rlp.decode(t)),Array.isArray(t)){if(t.length>e._fields.length)throw Error("wrong number of fields in data");t.forEach(function(r,t){e[e._fields[t]]=(0,c.toBuffer)(r)})}else if("object"==typeof t){var i=Object.keys(t);r.forEach(function(r){-1!==i.indexOf(r.name)&&(e[r.name]=t[r.name]),-1!==i.indexOf(r.alias)&&(e[r.alias]=t[r.alias])})}else throw Error("invalid data")}};r.defineProperties=f},3077:function(e,r,t){var n=t(48764).Buffer;Object.defineProperty(r,"__esModule",{value:!0}),r.hashPersonalMessage=r.isValidSignature=r.fromRpcSig=r.toCompactSig=r.toRpcSig=r.ecrecover=r.ecsign=void 0;var i=t(95053),a=t(50523),o=t(47107),s=t(91207),c=t(3323),f=t(89260);function u(e,r){var t=(0,f.toType)(e,f.TypeOutput.BN);if(t.eqn(0)||t.eqn(1))return(0,f.toType)(e,f.TypeOutput.BN);if(!r)return t.subn(27);var n=(0,f.toType)(r,f.TypeOutput.BN);return t.sub(n.muln(2).addn(35))}function d(e){var r=new a.BN(e);return r.eqn(0)||r.eqn(1)}r.ecsign=function(e,r,t){var a=(0,i.ecdsaSign)(e,r),o=a.signature,s=a.recid,c=n.from(o.slice(0,32)),u=n.from(o.slice(32,64));if(!t||"number"==typeof t){if(t&&!Number.isSafeInteger(t))throw Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");return{r:c,s:u,v:t?s+(2*t+35):s+27}}return{r:c,s:u,v:(0,f.toType)(t,f.TypeOutput.BN).muln(2).addn(35).addn(s).toArrayLike(n)}};var l=function(e,r,t,a,s){var c=n.concat([(0,o.setLengthLeft)(t,32),(0,o.setLengthLeft)(a,32)],64),f=u(r,s);if(!d(f))throw Error("Invalid signature v value");var l=(0,i.ecdsaRecover)(c,f.toNumber(),e);return n.from((0,i.publicKeyConvert)(l,!1).slice(1))};r.ecrecover=l;var h=function(e,r,t,i){var a=u(e,i);if(!d(a))throw Error("Invalid signature v value");return(0,o.bufferToHex)(n.concat([(0,o.setLengthLeft)(r,32),(0,o.setLengthLeft)(t,32),(0,o.toBuffer)(e)]))};r.toRpcSig=h;var p=function(e,r,t,i){var a=u(e,i);if(!d(a))throw Error("Invalid signature v value");var s=(0,f.toType)(e,f.TypeOutput.Number),c=t;return(s>28&&s%2==1||1===s||28===s)&&(c=n.from(t),c[0]|=128),(0,o.bufferToHex)(n.concat([(0,o.setLengthLeft)(r,32),(0,o.setLengthLeft)(c,32)]))};r.toCompactSig=p;var g=function(e){var r,t,n,i=(0,o.toBuffer)(e);if(i.length>=65)r=i.slice(0,32),t=i.slice(32,64),n=(0,o.bufferToInt)(i.slice(64));else if(64===i.length)r=i.slice(0,32),t=i.slice(32,64),n=(0,o.bufferToInt)(i.slice(32,33))>>7,t[0]&=127;else throw Error("Invalid signature length");return n<27&&(n+=27),{v:n,r:r,s:t}};r.fromRpcSig=g;var y=function(e,r,t,n,i){void 0===n&&(n=!0);var o=new a.BN("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),s=new a.BN("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);if(32!==r.length||32!==t.length||!d(u(e,i)))return!1;var c=new a.BN(r),f=new a.BN(t);return!(c.isZero()||c.gt(s)||f.isZero()||f.gt(s))&&(!n||1!==f.cmp(o))};r.isValidSignature=y;var m=function(e){(0,c.assertIsBuffer)(e);var r=n.from("\x19Ethereum Signed Message:\n".concat(e.length),"utf-8");return(0,s.keccak)(n.concat([r,e]))};r.hashPersonalMessage=m},89260:function(e,r,t){var n,i,a=t(48764).Buffer;Object.defineProperty(r,"__esModule",{value:!0}),r.toType=r.TypeOutput=r.bnToRlp=r.bnToUnpaddedBuffer=r.bnToHex=void 0;var o=t(50523),s=t(60571),c=t(47107);function f(e){return(0,c.unpadBuffer)(e.toArrayLike(a))}function u(e){return f(e)}r.bnToHex=function(e){return"0x".concat(e.toString(16))},r.bnToUnpaddedBuffer=f,r.bnToRlp=u,(n=i=r.TypeOutput||(r.TypeOutput={}))[n.Number=0]="Number",n[n.BN=1]="BN",n[n.Buffer=2]="Buffer",n[n.PrefixedHexString=3]="PrefixedHexString",r.toType=function(e,r){if(null===e)return null;if(void 0!==e){if("string"!=typeof e||(0,s.isHexString)(e)){if("number"==typeof e&&!Number.isSafeInteger(e))throw Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)")}else throw Error("A string must be provided with a 0x-prefix, given: ".concat(e));var t=(0,c.toBuffer)(e);if(r===i.Buffer)return t;if(r===i.BN)return new o.BN(t);if(r!==i.Number)return"0x".concat(t.toString("hex"));var n=new o.BN(t),a=new o.BN(Number.MAX_SAFE_INTEGER.toString());if(n.gt(a))throw Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative output type)");return n.toNumber()}}}}]);